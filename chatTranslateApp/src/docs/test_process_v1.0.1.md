# OCR 문장 파싱 기능 테스트 (v1.0.1)

버전 : v1.0.1

작성자 :  TigerP-MS

작성일 : 2025-02-08

테스트 대상 : `textToParse(String text)`

관련 파일 : `TextService.java`

---

## **1. 변경 사항 (Changelog)**

- **TC-04, TC-07, TC-09 테스트 실패 원인 수정 → 정상 통과 확인**
- `indexOf("]")`, `indexOf(":")`가 `1`이면 예외 처리 추가하여 오류 방지
- 사용자명이 빈 문자열(`""`)이면 메시지 객체를 생성하지 않도록 수정
- `split("\\[")`로 인해 `lines[0]`이 빈 문자열이 되던 문제 해결
- `id = 1`부터 시작하도록 수정하여 정상적인 ID 부여

---

## **2. 테스트 목표**

**OCR에서 감지된 문장을 올바르게 파싱하여 `List<TextEntry.Message>` 객체로 변환하는지 검증**

**잘못된 형식(`[]`, `:` 누락 등)이 입력되었을 때 안전하게 예외 처리되는지 확인**

**이전 버전(`v1.0.0`)에서 발생한 테스트 실패를 해결하고 정상 동작 여부 검증**

---

## **3. 테스트 환경**

### **테스트 도구**

- `JUnit 5`
- `Spring Boot Test`

### **소프트웨어 환경**

- `Java 23`
- `Spring Boot 3.4.1`
- `Gradle`

### **테스트 데이터**

| 테스트 케이스 ID | 입력 텍스트 | 예상 출력 | 비고 |
| --- | --- | --- | --- |
| TC-01 | `[12:30] Alice: Hello` | 1개의 메시지 객체 반환 | 정상 입력 |
| TC-02 | `[12:30] Alice: Hello\n` | 1개의 메시지 객체 반환 | 정상 입력 |
| TC-03 | `[12:30] Alice: Hello\n[12:31] Bob: Hi` | 2개의 메시지 객체 반환 | 여러 개의 메시지 |
| TC-04 | `Hello this is not formatted text` | 빈 리스트 반환 | 잘못된 형식 |
| TC-05 | `[12:30] Alice:` | 메시지 내용이 빈 채로 객체 생성 | 빈 메시지 입력 |
| TC-06 | `[12:50 Alice: No closing bracket` | 빈 리스트 | 대괄호 `]` 누락 |
| TC-07 | `12:51] Alice: Extra bracket at start` | 빈 리스트 | 대괄호 `[` 누락 |
| TC-08 | `[12:52] Alice No colon` | 빈 리스트 | `:` 누락 |
| TC-09 | `[12:53]: Message without username` | 빈 리스트 | 사용자명 없음 |

---

## **4. 테스트 케이스**

### **TC-01 : 단일 메시지 파싱 확인**

### **입력값**

```
[12:30] Alice: Hello
```

### **예상 출력**

| id | time | username | message | isTranslated |
| --- | --- | --- | --- | --- |
| 1 | 12:30 | Alice | Hello | 0 |

### **실행 결과**

✅ 테스트 성공

---

### **TC-02 : 단일 메시지 (줄바꿈 포함)**

### **입력값**

```
[12:30] Alice: Hello\
```

### **예상 출력**

| id | time | username | message | isTranslated |
| --- | --- | --- | --- | --- |
| 1 | 12:30 | Alice | Hello | 0 |

### **실행 결과**

✅ 테스트 성공

---

### **TC-03 : 여러 개의 메시지 파싱 확인**

### **입력값**

```
[12:30] Alice: Hello\n[12:31] Bob: Hi
```

### **예상 출력**

| id | time | username | message | isTranslated |
| --- | --- | --- | --- | --- |
| 1 | 12:30 | Alice | Hello | 0 |
| 2 | 12:31 | Bob | Hi | 0 |

### **실행 결과**

✅ 테스트 성공

---

### **TC-04 : 잘못된 형식의 메시지**

### **입력값**

```
Hello this is not formatted text
```

### **예상 출력**

빈 리스트 반환 (`[]`)

### **실행 결과**

✅ 테스트 성공

---

### **TC-05 : 빈 메시지 입력**

### **입력값**

```
[12:30] Alice:
```

### **예상 출력**

| id | time | username | message | isTranslated |
| --- | --- | --- | --- | --- |
| 1 | 12:30 | Alice | (빈 문자열) | 0 |

### **실행 결과**

✅ 테스트 성공

---

### **TC-06 : 닫는 대괄호 `]` 누락**

### **입력값**

```
[12:50 Alice: No closing bracke
```

### **예상 출력**

빈 리스트 반환 (`[]`)

### **실행 결과**

✅ 테스트 성공

---

### **TC-07 : 여는 대괄호 `[` 누락**

### **입력값**

```
12:51] Alice: Extra bracket at s
```

### **예상 출력**

빈 리스트 반환 (`[]`)

### **실행 결과**

✅ 테스트 성공

---

### **TC-08 : 콜론 `:` 누락**

### **입력값**

```
[12:52] Alice No colon
```

### **예상 출력**

빈 리스트 반환 (`[]`)

### **실행 결과**

✅ 테스트 성공

---

### **TC-09 : 사용자명 없음**

### **입력값**

```
[12:53]: Message without username
```

### **예상 출력**

빈 리스트 반환 (`[]`)

### **실행 결과**

✅ 테스트 성공

---

## **5. 테스트 결과 요약**

| 테스트 케이스 ID | 입력값 | 예상 출력 | 실행 결과 | 결과 |
| --- | --- | --- | --- | --- |
| **TC-01** | `[12:30] Alice: Hello` | 1개의 메시지 객체 반환 | 1개의 메시지 객체 반환 | ✅ 성공 |
| **TC-02** | `[12:30] Alice: Hello\n` | 1개의 메시지 객체 반환 | 1개의 메시지 객체 반환 | ✅ 성공 |
| **TC-03** | `[12:30] Alice: Hello\n[12:31] Bob: Hi` | 2개의 메시지 객체 반환 | 2개의 메시지 객체 반환 | ✅ 성공 |
| **TC-04** | `Hello this is not formatted text` | 빈 리스트 반환 | 빈 리스트 반환 | ✅ 성공 |
| **TC-05** | `[12:30] Alice:` | 메시지 내용이 빈 채로 객체 생성 | 메시지 내용이 빈 채로 객체 생성 | ✅ 성공 |
| **TC-06** | `[12:50 Alice: No closing bracket` | 빈 리스트 반환 | 빈 리스트 반환 | ✅ 성공 |
| **TC-07** | `12:51] Alice: Extra bracket at start` | 빈 리스트 반환 | 빈 리스트 반환 | ✅ 성공 |
| **TC-08** | `[12:52] Alice No colon` | 빈 리스트 반환 | 빈 리스트 반환 | ✅ 성공 |
| **TC-09** | `[12:53]: Message without username` | 빈 리스트 반환 | 빈 리스트 반환 | ✅ 성공 |